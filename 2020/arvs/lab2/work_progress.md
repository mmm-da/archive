1. Создать организационное подразделение (ОП) Employees с помощью консоли Active Directory и создать ОП Temp с помощью сценария.

При помощи консоли Active Directory - пользователи и компьютеры было создано ОП Employees. 

При помощи команды Powershell Create-ADOrganizationalUnit было создано ОП Temp.

![Созданные ОП](./files/p1.jpg)

2. Создать пользователей в ОП Employees и изменение их свойств.

![Создание пользователя Иван Иванов](./files/p2.jpg)

![Создание пользователя Петр Петров](./files/p3.jpg)

![Создание пользователя Макаров Даниил](./files/p4.jpg)

![Изменение свойств пользователя Макаров Даниил](./files/p5.jpg)

![Изменение свойств пользователя Иван Иванов](./files/p6.jpg)

![Изменение свойств пользователя Петр Петров](./files/p62.jpg)

3. При помощи команды Найти осуществите поиск пользователя Иван Иванов в вашем домене. При помощи команды Переместить переместите его в ОП Temp. Переместите объект пользователя обратно в ОП Employees с помощью сценария. С помощью сценария удалите ОП Temp.

![Поиск пользователя Иван Иванов](./files/p71.jpg)

![Получение и перемещение объекта - пользователь Иван Иванов при помощи сценария](./files/p72.jpg)

![Получение и удаление объекта - ОП Temp при помощи сценария](./files/p73.jpg)

4. Создать учетную запись пользователя для шаблона и установка необходимых свойств.

![Создание пользователя-шаблона](./files/p81.jpg)

![Установка пароля и отключение учетной записи](./files/p82.jpg)

![Заполнение полей свойств](./files/p83.jpg)

5. Копирование шаблона для создания учетных записей пользователей.

![Создание пользователя копированием шаблона](./files/p91.jpg)

![Проверка наследования свойств шаблона](./files/p92.jpg)

6. Создание .csv файла с следующим содержимым и импортирование его в AD при помощи утилиты csvde.

```csv
DN,objectClass,sAMAccountName,sn,givenName,userPrincipalName
"CN=Андрей Калиберда,OU=Employees,DC=povtas,DC=com",user,andrey.kalib,Калиберда,Андрей
"CN=Юрий Шелаев,OU=Employees,DC=povtas,DC=com",user,juriy.shell,Шелаев,Юрий
```

![Импортирование .csv файла](./files/p10.jpg)

![Проверка успешности импортирования](./files/p11.jpg)

7. Сброс пароля при помощи утилиты dsquery.

![Сброс пароля](./files/p12.jpg)

8. В контейнере Builtin консоли *Active Directory — пользователи и компьютеры* раскройте окно свойств группы Операторы печати. На вкладке Члены группы добавьте группу Пользователи домена.

![Добавление группы](./files/p13.jpg)

9. Создать директорию Profiles

![Создание директории Profiles](./files/p14.jpg)

10. Создать учетную записи - шаблон для профилей пользователей.

![Создание учетной записи](./files/p15.jpg)

11. Создание профиля и установка его для пользователя Петр Петров как обязательного профиля.

![Созданный профиль](./files/p16.jpg)

![Установка пути к профилю](./files/p17.jpg)

![Переименнованный профиль для установки обязательного профиля](./files/p18.jpg)

**Вывод**: Я ознакомился с объектами службы AD и научился создавать и управлять этими объектами при помощи различных утилит встроенных в Windows Server. В качестве графического интерфейса для создания объектов AD выступает оснастка *AD - пользователи и компьютеры*, а в качестве консольных инструментов встроенные модули AD в интерпретатор языка powershell.

**Контрольные вопросы**:

1. Что такое учетная запись пользователя?
   
2. Какими способами можно создавать учетные записи?

3. Перечислите свойства объекта пользователя.

4. Какие свойства учетной записи можно одновременно изменить для нескольких объектов пользователей?

5. Перечислите средства командной строки Active Directory.

6. Профили пользователя. Виды профилей.

**Ответы**:
 
1. Учетная запись пользователя — перечень сведений, определяющих персональные настройки пользователя, права доступа.

2. При помощи оснастки *AD - пользователи и компьютеры* или при помощи команды powershell Create-ADUser.\
   
3. * Общие (General) – основные свойства пользователя, которые задаются при создании учетной записи в AD (имя, фамилия, телефон, email и т.д.);
   * Адрес (Address);
   * Учетная запись (Account) – имя учетной записи (samAccountName, userPrincipalName). Здесь можно указать список компьютеров, на которых разрешено работать пользователю (LogonWorkstations), опции: пароль не истекает, пользователь не может сменить пароль, включена ли учетная запись и ее срок действия и т.д.;
   * Профиль (Profile) – можно настроить путь к профилю пользователя (в сценариях с перемещаемыми профилями); скрипт, выполняемый при входе, домашнюю папку, сетевой диск;
   * Телефоны (Telephones);
   * Организация (Organization) – должность, департамент, компания пользователя, имя менеджера.

4. Одновременно можно изменять некоторые свойства связанные с администрирование учетной записи (время входа-выхода), и персональную информацию которая не относится к конкретному человеку (кабинет, организация, адресс, домашняя папка, профиль учетной записи).

5. *  DSADD — добавляет объекты в Active Directory;
   *  DSGET — показывает свойства объектов, зарегистрирован­ных в Active Directory;
   * DSMOD.— изменяет свойства объектов, существующих в Active Directory;
   * DSMOVE — перемещает один объект в новое место в том же домене или переименовывает объект, не перемещая его;
   * DSQUERY — ищет объекты Active Directory по определен­ному критерию;
   * DSRM — удаляет объекты из Active Directory.

6. Профиль пользователя - персональные настройки компьютера закрепленные за пользователем.

Виды профилей:

   * локальный профиль, расположенный на конкретном компьютере и не хранящийся на сервере;
   * перемещаемый профиль, хранящийся на сервере и копируемый на любой компьютер, на котором регистрируется пользователь;
   * обязательный профиль, являющийся разновидностью перемещаемого профиля, настройки пользователя в котором не сохраняются после завершения сеанса.